function colorbar_bw(a){var d=Math.round(255/a),e=[],c=[],f=[];for(i=0;i<a;i+=1)e.push(0+d*i),c.push(0+d*i),f.push(0+d*i);return[e,c,f]}
function colorbar(a,d,e,c){this.cvalues=[];range=0.05*(a-d);a+=range;d+=range;spans=(a-d)/e;for(i=d;i<=a;i+=spans)this.cvalues.push(i);switch(c){case "grey":rgb=colorbar_grey(e);break;case "bw":rgb=colorbar_bw(e);break;case "jet":rgb=colorbar_jet(e)}this.r=rgb[0];this.g=rgb[1];this.b=rgb[2];this.pick_color=function(a){lst=this.r.length-1;var c=gs=bs=0;if(void 0===a)c=gs=bs=255;else if(a<=this.cvalues[0])c=gs=bs=0;else if(a>this.cvalues[lst])c=gs=bs=255;else if(a==this.cvalues[lst])c=gs=bs=0;else for(i in this.cvalues)if(0==
i)c=gs=bs=200;else if(sv=this.cvalues[i-1],hsv=this.cvalues[i],a>=sv&&a<hsv){c=this.r[i];gs=this.g[i];bs=this.b[i];break}return"rgb("+c+","+gs+","+bs+")"}}function colorbar_grey(a){mx=255;mn=70;span=Math.round((mx-mn)/a);r=g=b=[];for(i=0;i<a;i+=1)r.push(mn+span*i),g.push(mn+span*i),b.push(mn+span*i);return[r,g,b]}
function colorbar_hsv(){var a=[],d=[],e=[],c=Math.round(levels/5)-1,f=Math.round(255/c),a=[],d=[],e=[];for(i=0;i<=c;i+=1)a.push(0),d.push(0),e.push(i*f);for(i=0;i<=c;i+=1)a.push(0),d.push(i*f),e.push(255);for(i=0;i<=c;i+=1)a.push(i*f),d.push(255),e.push(255-i*f);for(i=0;i<=c;i+=1)a.push(255),d.push(255-i*f),e.push(0);for(i=0;i<=c;i+=1)a.push(255-i*f),d.push(0),e.push(0);return[a,d,e]}
function colorbar_jet(a){var a=Math.round(a/5)-1,d=Math.round(255/a),e=[],c=[],f=[];for(i=0;i<=a;i+=1)e.push(0),c.push(0),f.push(i*d);for(i=0;i<=a;i+=1)e.push(0),c.push(i*d),f.push(255);for(i=0;i<=a;i+=1)e.push(i*d),c.push(255),f.push(255-i*d);for(i=0;i<=a;i+=1)e.push(255),c.push(255-i*d),f.push(0);for(i=0;i<=a;i+=1)e.push(255-i*d),c.push(0),f.push(0);return[e,c,f]}
function Fig(a){this.ctx=document.getElementById(a).getContext("2d");this.x_label_offset=22;this.y_label_offset=35;this.w=$("#"+a).width();this.h=$("#"+a).height();this.w-=this.y_label_offset;this.h-=this.x_label_offset;this.clearPlot=function(){this.ctx.clearRect(0,0,this.w+this.y_label_offset,this.h+this.x_label_offset)}}function digit(a){return 10>a?"0"+a:a}
Fig.prototype.gridmesh=function(a,d,e,c){this.clearPlot();count=e.length;x_vals=a.length;y_vals=d.length;dy=d[d.length-1]-d[0];y_unitsize=this.h/dy;y_size=[];for(i in d)i*=1,dv=i==d.length-1?d[i]-d[i-1]:d[i+1]-d[i],y_size.push(dv*y_unitsize);dx=a[a.length-1]-a[0];x_unitsize=this.w/dx;x_size=[];for(j in a)j*=1,k=j+1,dv=j==a.length-1?a[j]-a[j-1]:a[k]-a[j],x_size.push(dv*x_unitsize);width=this.w/count;if(!c||"none"!=c.border)this.ctx.beginPath(),this.ctx.moveTo(this.y_label_offset-1,0),this.ctx.closePath(),
this.ctx.lineTo(this.y_label_offset-1,this.h+2),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(this.w+this.y_label_offset,this.h+1),this.ctx.closePath(),this.ctx.lineTo(this.y_label_offset-2,this.h+1),this.ctx.stroke();A=c&&c.min?c.min:Math.min.apply(Math,e[0]);B=c&&c.max?c.max:Math.max.apply(Math,e[0]);levels=c&&c.levels?c.levels:50;cmap=c&&c.cmap?c.cmap:"jet";cbr=new colorbar(B,A,levels,cmap);height=this.h/e[0].length;curr_x=this.y_label_offset;for(ob_key in e){val=e[ob_key];curr_y=this.h;
for(ht_key in val)v=val[ht_key],color=cbr.pick_color(v),this.ctx.fillStyle=color,this.ctx.fillRect(curr_x,curr_y-y_size[ht_key],x_size[ob_key],y_size[ht_key]),this.ctx.strokeStyle=color,this.ctx.strokeRect(curr_x,curr_y-y_size[ht_key],x_size[ob_key],y_size[ht_key]),curr_y-=y_size[ht_key];curr_x+=x_size[ob_key]}};function digit(a){return 10>a?"0"+a:a}
Fig.prototype.radar=function(a,d,e,c){this.clearPlot();this.plottype="radar";this.data={};this.data.r=d;this.data.az=a;w=this.w;h=this.h;smallest_dimension=w>h?h:w;gate_width=smallest_dimension/(2*d.length);if(!c||"none"!=c.border)this.ctx.beginPath(),this.ctx.moveTo(this.y_label_offset-1,0),this.ctx.closePath(),this.ctx.lineTo(this.y_label_offset-1,this.h+2),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(this.w+this.y_label_offset,this.h+1),this.ctx.closePath(),this.ctx.lineTo(this.y_label_offset-
2,this.h+1),this.ctx.stroke();A=c&&c.min?c.min:Math.min.apply(Math,e[0]);B=c&&c.max?c.max:Math.max.apply(Math,e[0]);levels=c&&c.levels?c.levels:50;cmap=c&&c.cmap?c.cmap:"jet";cbr=new colorbar(B,A,levels,cmap);x0=this.y_label_offset;y0=this.x_label_offset;ctx=this.ctx;az_max=a.length-1;for(az_key in e)for(rg_key in val=e[az_key],0==az_max?(az1=az_key*a,az2=az1+a):(az_key*=1,az_low=0==az_key?a[az_max]:a[az_key-1],az_n=az_low>a[az_key]?a[az_key]+2*Math.PI:a[az_key],az1=(az_low+az_n)/2,az1-=az1>2*Math.PI?
2*Math.PI:0,az_high=az_key==az_max?a[0]:a[az_key+1],az_high+=az_high<a[az_key]?2*Math.PI:0,az_n=a[az_key],az2=(az_high+az_n)/2,az2-=az2>2*Math.PI?2*Math.PI:0),az1-=Math.PI/2,az2-=Math.PI/2,val)v=val[rg_key],color=cbr.pick_color(v),ctx.fillStyle=color,ctx.strokeStyle=color,cx=w/2+x0,cy=h/2,r1=rg_key*gate_width,r2=r1+gate_width,ctx.beginPath(),ctx.arc(cx,cy,r2,az2,az1,!0),ctx.arc(cx,cy,r1,az1,az2,!1),ctx.closePath(),ctx.fill(),ctx.stroke()};function digit(a){return 10>a?"0"+a:a};

